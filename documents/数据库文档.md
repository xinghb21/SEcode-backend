## User   用户

### 数据表项

#### id (BigAuto)

含义：用户的ID

备注：主键，采用以1开始的主键自增。

#### name (String)

含义：用户的名称

备注：长度不超过128，所有用户名称不可重复，**无论是否处于同一业务实体**。

#### password (String)

含义：用户的密码散列

备注：密码明文长度不少于8，不超过32，必须包含英文字母和数字，采用`Django`自带的`make_password`方法生成散列字符串存储在数据库中，采用`check_password`方法验证密码。

#### entity  (BigInteger)

含义：用户所属的业务实体ID

默认：0

备注：不属于任何业务实体的用户存储0，一般而言是超级管理员。

#### department (BigInteger)

含义：用户所属的部门ID

默认：0

备注：不属于任何部门的用户存储0，一般而言是超级管理员和系统管理员。

#### system_super (Boolean)

含义：用户是否为超级管理员

默认：False

备注：是为True，否为False。只有该项为True的用户具有超级管理员权限。超级管理员一般只有一位。

#### entity_super (Boolean)

含义：用户是否为系统管理员

默认：False

备注：是为True，否为False。只有该项为True的用户具有系统管理员权限。每个业务实体的系统管理员一般只有一位。

#### asset_super (Boolean)

含义：用户是否为资产管理员

默认：False

备注：是为True，否为False。只有该项为True的用户具有资产管理员权限。每个部门的资产管理员一般只有一位。

#### on_log (Boolean)

含义：用户是否已经登录

默认：False

备注：是为True，否为False。只有处于False状态才可正常登录，登录状态下为True，手动登出和直接关闭网页均将其设置为False

#### locked (Boolean)

含义：用户是否被锁定

默认：False

备注：是为True，否为False。一般只有既非超级管理员又非系统管理员的用户才可被锁定，被锁定用户无法正常登录，并需要提示锁定操作者名称，一般是对应业务实体的系统管理员

### 数据样例

```json
{
	"id":2021010819,
    "name":"Hanyx",
    "password":"jd98un3p8oewfeh18bhfe9fg02",
    "entity":1104,
    "department":6,
    "system_super":False,
    "entity_super":False,
    "asset_super":True,
    "on_log":True,
    "locked":False
}
```

## Entity   业务实体

### 数据表项

#### id (BigAuto)

含义：业务实体的ID

备注：主键，采用以1开始的主键自增

#### name (String)

含义：业务实体的名称

备注：长度不超过128，所有业务实体名称不可重复

#### admin (BigInteger)

含义：业务实体的系统管理员的用户ID

默认：0

备注：未创建时为0

### 数据样例

```json
{
    "id":1104,
    "name":Tsinghua,
    "admin":1
}
```

## Department  部门

### 数据表项

#### id (BigAuto)

含义：部门的ID

备注：主键，采用1开始的主键自增

#### name (String)

含义：部门的名称

备注：长度不超过128，同一业务实体内不可重复，但**不同业务实体间可以重复**

#### entity (BigInteger)

含义：所属业务实体的ID

备注：必须在创建时即确定

#### parent (BigInteger)

含义：上属部门的ID

默认：0

备注：不存在记为0，此时该部门是业务实体的直接下属，不是根节点，而是深度为`1`的一层所有的节点

#### admin (BigInteger)

含义：部门的资产管理员ID

默认：0

备注：未创建时

### 数据样例

```json
{
    "id":6,
    "name":"CST2021",
    "entity":1104,
    "parent":0,
    "admin":2021010819
}
```

## Asset 资产

### 数据表项

#### id (BigAuto)

含义：资产的ID

备注：主键，采用1开始的主键自增

#### parent (BigInteger)

含义：上级资产ID

默认：0

备注：不存在记为0，即该资产在主从关系树中为根节点

#### department (BigInteger)

含义：资产所属的部门ID

备注：必须在创建时即确定。如要确定资产所属的业务实体和管理员，分别访问该部门的`entity`和`admin`表项

#### name (String)

含义：资产的名称

备注：长度不超过128，同一业务实体内不可重复，但**不同业务实体间可以重复**

#### type (Boolean)

含义：资产类型

默认：False

备注：False为**条目型**，True为**数量型**，一般不可更改

#### number (Integer)

含义：资产数量

默认：1

备注：条目型固定为1，数量型可变动

#### belonging (BigInteger)

含义：资产挂账人的用户ID

默认：部门的资产管理员用户ID

备注：资产仅能挂载在当前部门的成员上，否则需要执行调拨。（待定：维保时？）清退、删除状态时为0

#### price (Decimal{10,2})

含义：资产原价值

备注：必须在创建时确定，不可更改。最多有效数字10位，保留2位小数

#### life (Integer)

含义：资产使用年限

备注：以年为单位，必须在创建时确定，不可更改

#### create_time (BigInteger)

含义：资产创建时的时间

默认：创建时的时间

备注：时间戳，用于计算价值折旧

#### description (String)

含义：资产描述

默认：空

备注：长度不超过1024，由部门资产管理员添加和修改

#### additional (String)

含义：自定义属性

默认：`"{}"`

备注：由部门资产管理员添加和修改自定义属性的键值对，以字符串形式存储键值对，实际操作和显示时同其他属性，需要进行解析

#### status (Integer)

含义：资产状态

默认：0

备注：枚举，0闲置（挂载在资产管理员上），1在使用（挂载在`belonging`对应用户上），2维保（待定：挂载在？），3清退（无人挂账，不可使用，价值为0），4删除（测试使用，实际中不应出现）

### 数据样例

#### 样例1：条目型资产

```json
{
	"id":33,
	"parent":22,
    "department":6,
    "name":"RGB机械键盘",
    "type":False,
    "number":1,
    "belonging":2021010819,
    "price":1000.00,
    "life":10,
    "create_time":1679389395,
    "description":"本机械键盘与购入者的电脑主机配套，购入者表示不会借给任何人使用，哼哼~",
    "additional":"{}",
    "status":0
}
```

#### 样例2：数量型资产

```json
{
    "id":40,
    "parent":0,
    "department":6,
    "name":"0.5mm黑色墨水签字笔",
    "type":True,
    "number":15,
    "belonging":2021010817,
    "price":3.00,
    "life":50,
    "create_time":1680090000,
    "description":"如有遗失，借用者自费补偿。可以向部门主管要求购买替芯。",
    "additional":"{"品牌":"晨光文具"}",
	"status":1
}
```

## Pending  员工请求

### 数据表项

#### id (BigAuto)

含义：请求的ID

备注：主键，采用1开始的主键自增

#### department (BigInteger)

含义：所属的部门ID

备注：必须在创建时确定。如要确定请求所属的业务实体和管理员，分别访问该部门的`entity`和`admin`表项

#### initiator (BigInteger)

含义：申请人的用户ID

备注：必须在创建时确定。一般而言是普通员工

#### destination (BigInteger)

含义：在资产转移时目标用户ID

默认：0

备注：只有进行资产转移时有实际值，否则为默认值

#### asset (BigInteger)

含义：目标资产的ID

备注：必须在创建时确定

#### type (Integer)

含义：请求类型

备注：必须在创建时确认。枚举，1领用，2转移，3维保，4退库

#### description (String)

含义：申请人的描述（如申请理由、借用时间等）以及处理后的回复

默认：空

备注：长度不超过1024，未处理时格式为："申请人：申请人描述"，处理后**追加**审批回复"资产管理员：回复"

#### result (Integer)

含义：申请的处理结果

默认：0

备注：枚举，0未处理，1申请成功，2申请失败

#### request_time (BigInteger)

含义：申请时间

默认：申请时的时间

备注：时间戳

#### review_time (BigInteger)

含义：处理时间

默认：0

备注：未处理时记为0，处理完成替换为处理时的时间

### 数据样例

#### 样例1：未处理的请求

```json
{
    "id":1,
    "department":6,
    "initiator":2021010817,
    "destination":2021010815,
    "asset":40,
    "type":2,
    "description":"同学甲：申请把笔借给我朋友同学乙用一周，谢谢",
    "result":0,
    "request_time":1680090300,
    "review_time":0
}
```

#### 样例2：处理的请求

```json
{
    "id":2,
    "department":6,
    "initiator":2021010817,
    "destination":0,
    "asset":33,
    "type":1,
    "description":"同学甲：能不能借用一下你的机械键盘呀，谢谢喵~ \n Hanyx:请阅读资产描述了解该资产是否可被领用",
    "result":2,
    "request_time":1680090300,
    "review_time":1680090314
}
```

